<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>小程序WebSocket打印文字兼自动滚动（chatgpt） | Aiden&#39;s blog</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="https://cdn.jsdelivr.net/gh/Aiden124578/my_blog@1.8.3/docs/.vuepress/public/img/iconfont.ico">
    <script data-ad-client="ca-pub-7828333725993554" async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <meta name="description" content="web前端技术博客,简洁至上,专注web前端学习与总结。JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github等技术文章。">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="code-JnW6yLy9qt">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/my_blog/assets/css/0.styles.7c9df909.css" as="style"><link rel="preload" href="/my_blog/assets/js/app.2b316682.js" as="script"><link rel="preload" href="/my_blog/assets/js/2.f62b317f.js" as="script"><link rel="preload" href="/my_blog/assets/js/90.12f92057.js" as="script"><link rel="prefetch" href="/my_blog/assets/js/10.91477b68.js"><link rel="prefetch" href="/my_blog/assets/js/100.1aa928d6.js"><link rel="prefetch" href="/my_blog/assets/js/101.a8a2090f.js"><link rel="prefetch" href="/my_blog/assets/js/102.99044dd2.js"><link rel="prefetch" href="/my_blog/assets/js/103.cb7d1bed.js"><link rel="prefetch" href="/my_blog/assets/js/104.cee6ecd2.js"><link rel="prefetch" href="/my_blog/assets/js/105.f701b9ec.js"><link rel="prefetch" href="/my_blog/assets/js/106.0f6a8554.js"><link rel="prefetch" href="/my_blog/assets/js/107.0eb11fb3.js"><link rel="prefetch" href="/my_blog/assets/js/108.4be81d6f.js"><link rel="prefetch" href="/my_blog/assets/js/109.9b426503.js"><link rel="prefetch" href="/my_blog/assets/js/11.4e8e3474.js"><link rel="prefetch" href="/my_blog/assets/js/110.22fa4235.js"><link rel="prefetch" href="/my_blog/assets/js/111.8568dd8b.js"><link rel="prefetch" href="/my_blog/assets/js/112.12bf7a27.js"><link rel="prefetch" href="/my_blog/assets/js/113.ea17c45a.js"><link rel="prefetch" href="/my_blog/assets/js/114.4c2e763f.js"><link rel="prefetch" href="/my_blog/assets/js/115.746e85ee.js"><link rel="prefetch" href="/my_blog/assets/js/116.0b54b75c.js"><link rel="prefetch" href="/my_blog/assets/js/117.cd537229.js"><link rel="prefetch" href="/my_blog/assets/js/118.7011ad16.js"><link rel="prefetch" href="/my_blog/assets/js/119.0bc7be76.js"><link rel="prefetch" href="/my_blog/assets/js/12.86f2c77c.js"><link rel="prefetch" href="/my_blog/assets/js/120.0e7a43be.js"><link rel="prefetch" href="/my_blog/assets/js/121.351abe50.js"><link rel="prefetch" href="/my_blog/assets/js/122.2a9b241f.js"><link rel="prefetch" href="/my_blog/assets/js/123.6af6bda0.js"><link rel="prefetch" href="/my_blog/assets/js/124.2322d897.js"><link rel="prefetch" href="/my_blog/assets/js/125.d1265c8d.js"><link rel="prefetch" href="/my_blog/assets/js/126.8e5335d3.js"><link rel="prefetch" href="/my_blog/assets/js/127.0b76e179.js"><link rel="prefetch" href="/my_blog/assets/js/128.a0cafb36.js"><link rel="prefetch" href="/my_blog/assets/js/129.f8a55fd8.js"><link rel="prefetch" href="/my_blog/assets/js/13.132de6f5.js"><link rel="prefetch" href="/my_blog/assets/js/130.65bc36f4.js"><link rel="prefetch" href="/my_blog/assets/js/131.1a0553c7.js"><link rel="prefetch" href="/my_blog/assets/js/132.646d25ba.js"><link rel="prefetch" href="/my_blog/assets/js/133.d0449594.js"><link rel="prefetch" href="/my_blog/assets/js/134.783e258d.js"><link rel="prefetch" href="/my_blog/assets/js/135.ea68a04f.js"><link rel="prefetch" href="/my_blog/assets/js/136.6ac90171.js"><link rel="prefetch" href="/my_blog/assets/js/137.07b988eb.js"><link rel="prefetch" href="/my_blog/assets/js/138.da999fd1.js"><link rel="prefetch" href="/my_blog/assets/js/139.ad70ed36.js"><link rel="prefetch" href="/my_blog/assets/js/14.ed7b4167.js"><link rel="prefetch" href="/my_blog/assets/js/140.b1bb39c4.js"><link rel="prefetch" href="/my_blog/assets/js/141.e6649b9d.js"><link rel="prefetch" href="/my_blog/assets/js/142.4d344215.js"><link rel="prefetch" href="/my_blog/assets/js/143.82c984f9.js"><link rel="prefetch" href="/my_blog/assets/js/144.d9627e4d.js"><link rel="prefetch" href="/my_blog/assets/js/145.dc19ee1a.js"><link rel="prefetch" href="/my_blog/assets/js/146.cd2f46fd.js"><link rel="prefetch" href="/my_blog/assets/js/147.4a7c4edf.js"><link rel="prefetch" href="/my_blog/assets/js/148.ed0aabe1.js"><link rel="prefetch" href="/my_blog/assets/js/149.a1e2b287.js"><link rel="prefetch" href="/my_blog/assets/js/15.1236807e.js"><link rel="prefetch" href="/my_blog/assets/js/150.9ec98438.js"><link rel="prefetch" href="/my_blog/assets/js/151.922ec022.js"><link rel="prefetch" href="/my_blog/assets/js/152.bbce0363.js"><link rel="prefetch" href="/my_blog/assets/js/153.8ed85f76.js"><link rel="prefetch" href="/my_blog/assets/js/154.32aad633.js"><link rel="prefetch" href="/my_blog/assets/js/155.4707b172.js"><link rel="prefetch" href="/my_blog/assets/js/156.2f4b802b.js"><link rel="prefetch" href="/my_blog/assets/js/157.59a7b40e.js"><link rel="prefetch" href="/my_blog/assets/js/158.d01f1465.js"><link rel="prefetch" href="/my_blog/assets/js/159.33dadf79.js"><link rel="prefetch" href="/my_blog/assets/js/16.b02853ec.js"><link rel="prefetch" href="/my_blog/assets/js/160.edcf99ab.js"><link rel="prefetch" href="/my_blog/assets/js/161.17fdb417.js"><link rel="prefetch" href="/my_blog/assets/js/162.9607cf30.js"><link rel="prefetch" href="/my_blog/assets/js/163.7a450240.js"><link rel="prefetch" href="/my_blog/assets/js/164.d6d1d9a8.js"><link rel="prefetch" href="/my_blog/assets/js/165.ee74b8e7.js"><link rel="prefetch" href="/my_blog/assets/js/166.75a0e2ec.js"><link rel="prefetch" href="/my_blog/assets/js/167.2fd488b1.js"><link rel="prefetch" href="/my_blog/assets/js/168.2435cb2e.js"><link rel="prefetch" href="/my_blog/assets/js/169.781a1b9d.js"><link rel="prefetch" href="/my_blog/assets/js/17.25a88a99.js"><link rel="prefetch" href="/my_blog/assets/js/170.05bc82d1.js"><link rel="prefetch" href="/my_blog/assets/js/171.7c01fc66.js"><link rel="prefetch" href="/my_blog/assets/js/172.08ed5429.js"><link rel="prefetch" href="/my_blog/assets/js/173.897e9178.js"><link rel="prefetch" href="/my_blog/assets/js/174.0520b37c.js"><link rel="prefetch" href="/my_blog/assets/js/175.de04559c.js"><link rel="prefetch" href="/my_blog/assets/js/176.98f16f1e.js"><link rel="prefetch" href="/my_blog/assets/js/177.37489dea.js"><link rel="prefetch" href="/my_blog/assets/js/178.af1019fa.js"><link rel="prefetch" href="/my_blog/assets/js/179.4d45a699.js"><link rel="prefetch" href="/my_blog/assets/js/18.936dcb4f.js"><link rel="prefetch" href="/my_blog/assets/js/180.9f53e7b7.js"><link rel="prefetch" href="/my_blog/assets/js/181.afbedf0b.js"><link rel="prefetch" href="/my_blog/assets/js/182.cc49f832.js"><link rel="prefetch" href="/my_blog/assets/js/183.f02e595a.js"><link rel="prefetch" href="/my_blog/assets/js/184.be3fcb17.js"><link rel="prefetch" href="/my_blog/assets/js/185.efb1dc1b.js"><link rel="prefetch" href="/my_blog/assets/js/186.1ef74232.js"><link rel="prefetch" href="/my_blog/assets/js/187.a3811744.js"><link rel="prefetch" href="/my_blog/assets/js/188.f2f3e85e.js"><link rel="prefetch" href="/my_blog/assets/js/189.5ab109dd.js"><link rel="prefetch" href="/my_blog/assets/js/19.03215bc7.js"><link rel="prefetch" href="/my_blog/assets/js/190.215b08da.js"><link rel="prefetch" href="/my_blog/assets/js/191.e99abccf.js"><link rel="prefetch" href="/my_blog/assets/js/192.d35f29cb.js"><link rel="prefetch" href="/my_blog/assets/js/193.a7235703.js"><link rel="prefetch" href="/my_blog/assets/js/194.6a9ad02c.js"><link rel="prefetch" href="/my_blog/assets/js/195.5e6cc055.js"><link rel="prefetch" href="/my_blog/assets/js/196.117e2c4a.js"><link rel="prefetch" href="/my_blog/assets/js/197.15ef330b.js"><link rel="prefetch" href="/my_blog/assets/js/198.850a55ff.js"><link rel="prefetch" href="/my_blog/assets/js/199.33e0246a.js"><link rel="prefetch" href="/my_blog/assets/js/20.a015b6eb.js"><link rel="prefetch" href="/my_blog/assets/js/200.646bb87e.js"><link rel="prefetch" href="/my_blog/assets/js/201.e198c2b5.js"><link rel="prefetch" href="/my_blog/assets/js/202.f8bd345f.js"><link rel="prefetch" href="/my_blog/assets/js/203.4730d03a.js"><link rel="prefetch" href="/my_blog/assets/js/204.36154b7f.js"><link rel="prefetch" href="/my_blog/assets/js/205.f3c189b2.js"><link rel="prefetch" href="/my_blog/assets/js/206.9701d004.js"><link rel="prefetch" href="/my_blog/assets/js/207.58a27838.js"><link rel="prefetch" href="/my_blog/assets/js/208.70b95eba.js"><link rel="prefetch" href="/my_blog/assets/js/209.4402ead2.js"><link rel="prefetch" href="/my_blog/assets/js/21.5dad3855.js"><link rel="prefetch" href="/my_blog/assets/js/210.2615ef76.js"><link rel="prefetch" href="/my_blog/assets/js/211.fd98901e.js"><link rel="prefetch" href="/my_blog/assets/js/212.be68f814.js"><link rel="prefetch" href="/my_blog/assets/js/213.8cd7757a.js"><link rel="prefetch" href="/my_blog/assets/js/214.6f212488.js"><link rel="prefetch" href="/my_blog/assets/js/215.b5c0f38e.js"><link rel="prefetch" href="/my_blog/assets/js/216.1a71a357.js"><link rel="prefetch" href="/my_blog/assets/js/217.cc8d30cb.js"><link rel="prefetch" href="/my_blog/assets/js/218.27f5e3db.js"><link rel="prefetch" href="/my_blog/assets/js/219.231ed249.js"><link rel="prefetch" href="/my_blog/assets/js/22.518752d6.js"><link rel="prefetch" href="/my_blog/assets/js/220.99e9fd60.js"><link rel="prefetch" href="/my_blog/assets/js/221.4fed77da.js"><link rel="prefetch" href="/my_blog/assets/js/222.6f493aff.js"><link rel="prefetch" href="/my_blog/assets/js/223.a2484693.js"><link rel="prefetch" href="/my_blog/assets/js/224.f87679c9.js"><link rel="prefetch" href="/my_blog/assets/js/225.0ebbdf69.js"><link rel="prefetch" href="/my_blog/assets/js/226.46c1e1e2.js"><link rel="prefetch" href="/my_blog/assets/js/227.965790e4.js"><link rel="prefetch" href="/my_blog/assets/js/228.05a1a504.js"><link rel="prefetch" href="/my_blog/assets/js/229.bd28b093.js"><link rel="prefetch" href="/my_blog/assets/js/23.cfb48774.js"><link rel="prefetch" href="/my_blog/assets/js/230.2c13c5e4.js"><link rel="prefetch" href="/my_blog/assets/js/231.ed0293f4.js"><link rel="prefetch" href="/my_blog/assets/js/232.0e18945d.js"><link rel="prefetch" href="/my_blog/assets/js/233.91e26768.js"><link rel="prefetch" href="/my_blog/assets/js/234.185f8950.js"><link rel="prefetch" href="/my_blog/assets/js/235.3f9eeef3.js"><link rel="prefetch" href="/my_blog/assets/js/236.659601f3.js"><link rel="prefetch" href="/my_blog/assets/js/237.63c5374f.js"><link rel="prefetch" href="/my_blog/assets/js/238.74e55c2f.js"><link rel="prefetch" href="/my_blog/assets/js/239.c1c9aced.js"><link rel="prefetch" href="/my_blog/assets/js/24.60f3ebaf.js"><link rel="prefetch" href="/my_blog/assets/js/240.3cd66de4.js"><link rel="prefetch" href="/my_blog/assets/js/241.a5e57ccb.js"><link rel="prefetch" href="/my_blog/assets/js/242.75d40824.js"><link rel="prefetch" href="/my_blog/assets/js/243.091950c2.js"><link rel="prefetch" href="/my_blog/assets/js/244.41b1bdb4.js"><link rel="prefetch" href="/my_blog/assets/js/245.702a6fc2.js"><link rel="prefetch" href="/my_blog/assets/js/246.9a347160.js"><link rel="prefetch" href="/my_blog/assets/js/247.a03705c1.js"><link rel="prefetch" href="/my_blog/assets/js/248.ff00d243.js"><link rel="prefetch" href="/my_blog/assets/js/249.69cdb86d.js"><link rel="prefetch" href="/my_blog/assets/js/25.29b5d176.js"><link rel="prefetch" href="/my_blog/assets/js/250.b1113c1d.js"><link rel="prefetch" href="/my_blog/assets/js/251.173005e7.js"><link rel="prefetch" href="/my_blog/assets/js/252.edc88d9f.js"><link rel="prefetch" href="/my_blog/assets/js/253.d7a08cef.js"><link rel="prefetch" href="/my_blog/assets/js/254.90362179.js"><link rel="prefetch" href="/my_blog/assets/js/255.ffaa0a8e.js"><link rel="prefetch" href="/my_blog/assets/js/256.b21aa51e.js"><link rel="prefetch" href="/my_blog/assets/js/257.38aae386.js"><link rel="prefetch" href="/my_blog/assets/js/258.77a30d51.js"><link rel="prefetch" href="/my_blog/assets/js/259.52cf6fd4.js"><link rel="prefetch" href="/my_blog/assets/js/26.de890bc6.js"><link rel="prefetch" href="/my_blog/assets/js/260.88ad0fb6.js"><link rel="prefetch" href="/my_blog/assets/js/261.6b4e2037.js"><link rel="prefetch" href="/my_blog/assets/js/262.526b706b.js"><link rel="prefetch" href="/my_blog/assets/js/263.6a4bf272.js"><link rel="prefetch" href="/my_blog/assets/js/264.111880a9.js"><link rel="prefetch" href="/my_blog/assets/js/265.66222dde.js"><link rel="prefetch" href="/my_blog/assets/js/266.e21c42f6.js"><link rel="prefetch" href="/my_blog/assets/js/267.7c3e4d30.js"><link rel="prefetch" href="/my_blog/assets/js/268.b063f4a2.js"><link rel="prefetch" href="/my_blog/assets/js/269.a41f4800.js"><link rel="prefetch" href="/my_blog/assets/js/27.714a5320.js"><link rel="prefetch" href="/my_blog/assets/js/28.2095b30e.js"><link rel="prefetch" href="/my_blog/assets/js/29.f81e0376.js"><link rel="prefetch" href="/my_blog/assets/js/3.8cd35247.js"><link rel="prefetch" href="/my_blog/assets/js/30.595d2dfa.js"><link rel="prefetch" href="/my_blog/assets/js/31.4c86fae3.js"><link rel="prefetch" href="/my_blog/assets/js/32.437b191d.js"><link rel="prefetch" href="/my_blog/assets/js/33.f948b446.js"><link rel="prefetch" href="/my_blog/assets/js/34.849abbac.js"><link rel="prefetch" href="/my_blog/assets/js/35.cef097e8.js"><link rel="prefetch" href="/my_blog/assets/js/36.276098dc.js"><link rel="prefetch" href="/my_blog/assets/js/37.ea8b8188.js"><link rel="prefetch" href="/my_blog/assets/js/38.ac79553e.js"><link rel="prefetch" href="/my_blog/assets/js/39.b36bd5a8.js"><link rel="prefetch" href="/my_blog/assets/js/4.0c1d4c03.js"><link rel="prefetch" href="/my_blog/assets/js/40.07d3b135.js"><link rel="prefetch" href="/my_blog/assets/js/41.2058ddef.js"><link rel="prefetch" href="/my_blog/assets/js/42.1cd3826a.js"><link rel="prefetch" href="/my_blog/assets/js/43.8d472c10.js"><link rel="prefetch" href="/my_blog/assets/js/44.710e5aff.js"><link rel="prefetch" href="/my_blog/assets/js/45.dd487eae.js"><link rel="prefetch" href="/my_blog/assets/js/46.2bf3ceff.js"><link rel="prefetch" href="/my_blog/assets/js/47.aaaa13b7.js"><link rel="prefetch" href="/my_blog/assets/js/48.1308ba74.js"><link rel="prefetch" href="/my_blog/assets/js/49.f0015fe5.js"><link rel="prefetch" href="/my_blog/assets/js/5.a4604477.js"><link rel="prefetch" href="/my_blog/assets/js/50.49fbd3fb.js"><link rel="prefetch" href="/my_blog/assets/js/51.91a655aa.js"><link rel="prefetch" href="/my_blog/assets/js/52.1f5aa004.js"><link rel="prefetch" href="/my_blog/assets/js/53.076ddceb.js"><link rel="prefetch" href="/my_blog/assets/js/54.ff01be55.js"><link rel="prefetch" href="/my_blog/assets/js/55.8a05b66b.js"><link rel="prefetch" href="/my_blog/assets/js/56.5c666260.js"><link rel="prefetch" href="/my_blog/assets/js/57.d19875f3.js"><link rel="prefetch" href="/my_blog/assets/js/58.79f303c8.js"><link rel="prefetch" href="/my_blog/assets/js/59.17a7e819.js"><link rel="prefetch" href="/my_blog/assets/js/6.702bf14a.js"><link rel="prefetch" href="/my_blog/assets/js/60.bf8f4096.js"><link rel="prefetch" href="/my_blog/assets/js/61.7c1d270c.js"><link rel="prefetch" href="/my_blog/assets/js/62.ebb2d647.js"><link rel="prefetch" href="/my_blog/assets/js/63.b9037487.js"><link rel="prefetch" href="/my_blog/assets/js/64.71856e25.js"><link rel="prefetch" href="/my_blog/assets/js/65.054e8360.js"><link rel="prefetch" href="/my_blog/assets/js/66.f87df7ed.js"><link rel="prefetch" href="/my_blog/assets/js/67.e54781d0.js"><link rel="prefetch" href="/my_blog/assets/js/68.459e77c3.js"><link rel="prefetch" href="/my_blog/assets/js/69.e909afa2.js"><link rel="prefetch" href="/my_blog/assets/js/7.121aaba6.js"><link rel="prefetch" href="/my_blog/assets/js/70.cf767b82.js"><link rel="prefetch" href="/my_blog/assets/js/71.5d687496.js"><link rel="prefetch" href="/my_blog/assets/js/72.334dd6be.js"><link rel="prefetch" href="/my_blog/assets/js/73.f30f2ca2.js"><link rel="prefetch" href="/my_blog/assets/js/74.c46ea4ff.js"><link rel="prefetch" href="/my_blog/assets/js/75.b8839bdb.js"><link rel="prefetch" href="/my_blog/assets/js/76.e6f464fe.js"><link rel="prefetch" href="/my_blog/assets/js/77.e506a508.js"><link rel="prefetch" href="/my_blog/assets/js/78.d7478c6b.js"><link rel="prefetch" href="/my_blog/assets/js/79.a7b8dd15.js"><link rel="prefetch" href="/my_blog/assets/js/8.2c6b16fc.js"><link rel="prefetch" href="/my_blog/assets/js/80.96f36ca5.js"><link rel="prefetch" href="/my_blog/assets/js/81.d42075ae.js"><link rel="prefetch" href="/my_blog/assets/js/82.a08fb156.js"><link rel="prefetch" href="/my_blog/assets/js/83.c45bc7de.js"><link rel="prefetch" href="/my_blog/assets/js/84.0ee37f88.js"><link rel="prefetch" href="/my_blog/assets/js/85.b1f39b5e.js"><link rel="prefetch" href="/my_blog/assets/js/86.ea374b89.js"><link rel="prefetch" href="/my_blog/assets/js/87.13e634dd.js"><link rel="prefetch" href="/my_blog/assets/js/88.be040338.js"><link rel="prefetch" href="/my_blog/assets/js/89.6b6ecc70.js"><link rel="prefetch" href="/my_blog/assets/js/9.30b9fac3.js"><link rel="prefetch" href="/my_blog/assets/js/91.f23b5ffd.js"><link rel="prefetch" href="/my_blog/assets/js/92.c8da7d07.js"><link rel="prefetch" href="/my_blog/assets/js/93.6ebcdc84.js"><link rel="prefetch" href="/my_blog/assets/js/94.e48cf467.js"><link rel="prefetch" href="/my_blog/assets/js/95.f554dd4e.js"><link rel="prefetch" href="/my_blog/assets/js/96.4ed11d68.js"><link rel="prefetch" href="/my_blog/assets/js/97.69938884.js"><link rel="prefetch" href="/my_blog/assets/js/98.e774d4da.js"><link rel="prefetch" href="/my_blog/assets/js/99.28954c3f.js">
    <link rel="stylesheet" href="/my_blog/assets/css/0.styles.7c9df909.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/my_blog/" class="home-link router-link-active"><img src="https://cdn.jsdelivr.net/gh/Aiden124578/my_blog@1.8.3/docs/.vuepress/public/img/AD-logo.png" alt="Aiden's blog" class="logo"> <span class="site-name can-hide">Aiden's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/my_blog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/my_blog/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my_blog/pages/8143cc480faf9a11/" class="nav-link">JavaScript</a></li><li class="dropdown-subitem"><a href="/my_blog/pages/5d463fbdb172d43b/" class="nav-link">Vue</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my_blog/note/javascript/" class="nav-link">JavaScript教程</a></li><li class="dropdown-subitem"><a href="/my_blog/note/js/" class="nav-link">JavaScript高级程序设计</a></li><li class="dropdown-subitem"><a href="/my_blog/note/es6/" class="nav-link">ES6 教程</a></li><li class="dropdown-subitem"><a href="/my_blog/note/vue/" class="nav-link">Vue</a></li><li class="dropdown-subitem"><a href="/my_blog/pages/690271/" class="nav-link">Vue3.0</a></li><li class="dropdown-subitem"><a href="/my_blog/note/react/" class="nav-link">React</a></li><li class="dropdown-subitem"><a href="/my_blog/note/typescript-axios/" class="nav-link">TypeScript 从零实现 axios</a></li><li class="dropdown-subitem"><a href="/my_blog/note/git/" class="nav-link">Git</a></li><li class="dropdown-subitem"><a href="/my_blog/pages/51afd6/" class="nav-link">TypeScript</a></li><li class="dropdown-subitem"><a href="/my_blog/pages/4643cd/" class="nav-link">JS设计模式总结</a></li><li class="dropdown-subitem"><a href="/my_blog/note/wx-miniprogram/" class="nav-link">小程序</a></li><li class="dropdown-subitem"><a href="/my_blog/pages/f342ec/" class="nav-link">小程序云开发</a></li><li class="dropdown-subitem"><a href="/my_blog/pages/echarts/" class="nav-link">Echarts</a></li><li class="dropdown-subitem"><a href="/my_blog/pages/92a49d/" class="nav-link">微前端</a></li><li class="dropdown-subitem"><a href="/my_blog/pages/e1dcd1/" class="nav-link">H5</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="页面" class="dropdown-title"><a href="/my_blog/ui/" class="link-title">页面</a> <span class="title" style="display:none;">页面</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my_blog/pages/8309a5b876fc95e3/" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/0a83b083bdf257cb/" class="nav-link">CSS</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/my_blog/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my_blog/pages/9a7ee40fc232253e/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/pages/nodejs/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li><li class="dropdown-item"><!----> <a href="/my_blog/note/seo/baidu/" class="nav-link">搜索引擎</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/2588a7/" class="nav-link">ES系列</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/7d67e2/" class="nav-link">经典面试题</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/7a69e8/" class="nav-link">知识点总结</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/uni-app/" class="nav-link">uni-app</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/leetcode/" class="nav-link">算法</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/f4c038/" class="nav-link">Vue3实战</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/fcb539/" aria-current="page" class="nav-link router-link-exact-active router-link-active">小程序chatgpt</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/12985d/" class="nav-link">小程序配网流程</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/785e56/" class="nav-link">程序WIFI配网</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/b07c41/" class="nav-link">小程序WebSocket</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/628a97/" class="nav-link">H5 WebSocket</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/66e106/" class="nav-link">H5 TTS</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/8deb1d/" class="nav-link">Vue3实现OSS存储</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/d9915d/" class="nav-link">大文件分片上传</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/my_blog/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my_blog/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/my_blog/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/my_blog/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/my_blog/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/my_blog/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my_blog/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/my_blog/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/my_blog/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/Aiden124578/my_blog/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://pic.imgdb.cn/item/612859a444eaada739759616.jpg"> <div class="blogger-info"><h3>Aiden Wu</h3> <span>前端界的小学生</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/my_blog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/my_blog/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my_blog/pages/8143cc480faf9a11/" class="nav-link">JavaScript</a></li><li class="dropdown-subitem"><a href="/my_blog/pages/5d463fbdb172d43b/" class="nav-link">Vue</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my_blog/note/javascript/" class="nav-link">JavaScript教程</a></li><li class="dropdown-subitem"><a href="/my_blog/note/js/" class="nav-link">JavaScript高级程序设计</a></li><li class="dropdown-subitem"><a href="/my_blog/note/es6/" class="nav-link">ES6 教程</a></li><li class="dropdown-subitem"><a href="/my_blog/note/vue/" class="nav-link">Vue</a></li><li class="dropdown-subitem"><a href="/my_blog/pages/690271/" class="nav-link">Vue3.0</a></li><li class="dropdown-subitem"><a href="/my_blog/note/react/" class="nav-link">React</a></li><li class="dropdown-subitem"><a href="/my_blog/note/typescript-axios/" class="nav-link">TypeScript 从零实现 axios</a></li><li class="dropdown-subitem"><a href="/my_blog/note/git/" class="nav-link">Git</a></li><li class="dropdown-subitem"><a href="/my_blog/pages/51afd6/" class="nav-link">TypeScript</a></li><li class="dropdown-subitem"><a href="/my_blog/pages/4643cd/" class="nav-link">JS设计模式总结</a></li><li class="dropdown-subitem"><a href="/my_blog/note/wx-miniprogram/" class="nav-link">小程序</a></li><li class="dropdown-subitem"><a href="/my_blog/pages/f342ec/" class="nav-link">小程序云开发</a></li><li class="dropdown-subitem"><a href="/my_blog/pages/echarts/" class="nav-link">Echarts</a></li><li class="dropdown-subitem"><a href="/my_blog/pages/92a49d/" class="nav-link">微前端</a></li><li class="dropdown-subitem"><a href="/my_blog/pages/e1dcd1/" class="nav-link">H5</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="页面" class="dropdown-title"><a href="/my_blog/ui/" class="link-title">页面</a> <span class="title" style="display:none;">页面</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my_blog/pages/8309a5b876fc95e3/" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/0a83b083bdf257cb/" class="nav-link">CSS</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/my_blog/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my_blog/pages/9a7ee40fc232253e/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/pages/nodejs/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li><li class="dropdown-item"><!----> <a href="/my_blog/note/seo/baidu/" class="nav-link">搜索引擎</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/2588a7/" class="nav-link">ES系列</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/7d67e2/" class="nav-link">经典面试题</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/7a69e8/" class="nav-link">知识点总结</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/uni-app/" class="nav-link">uni-app</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/leetcode/" class="nav-link">算法</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/f4c038/" class="nav-link">Vue3实战</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/fcb539/" aria-current="page" class="nav-link router-link-exact-active router-link-active">小程序chatgpt</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/12985d/" class="nav-link">小程序配网流程</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/785e56/" class="nav-link">程序WIFI配网</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/b07c41/" class="nav-link">小程序WebSocket</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/628a97/" class="nav-link">H5 WebSocket</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/66e106/" class="nav-link">H5 TTS</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/8deb1d/" class="nav-link">Vue3实现OSS存储</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/d9915d/" class="nav-link">大文件分片上传</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/my_blog/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my_blog/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/my_blog/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/my_blog/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/my_blog/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/my_blog/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/my_blog/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my_blog/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/my_blog/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/my_blog/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/Aiden124578/my_blog/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>技术文档</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>GitHub技巧</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Nodejs</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>博客搭建</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>搜索引擎</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ES系列</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>经典面试题</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>知识点总结</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>uni-app</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>算法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue3实战</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>小程序chatgpt</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/my_blog/pages/fcb539/" aria-current="page" class="active sidebar-link">小程序WebSocket打印文字兼自动滚动（chatgpt）</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>小程序WIFI配网</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>小程序配网流程</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>小程序WebSocket</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>H5 WebSocket</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>H5 TTS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue3实现OSS存储</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>大文件分片上传</span> <span class="arrow right"></span></p> <!----></section></li></ul> <div class="sidebar-slot sidebar-slot-bottom"><!-- 正方形 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="3508773082"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div></aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/my_blog/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/my_blog/technology/#技术" data-v-06225672>技术</a></li><li data-v-06225672><a href="/my_blog/technology/#小程序chatgpt" data-v-06225672>小程序chatgpt</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/Aiden124578" target="_blank" title="作者" class="beLink" data-v-06225672>wushengxin</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2024-08-05</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><!----> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">小程序WebSocket打印文字兼自动滚动（chatgpt）<!----></h1> <div class="page-slot page-slot-top"><!-- 固定100% * 90px可显示，max-height:90px未见显示-->
     <ins class="adsbygoogle"
          style="display:inline-block;width:100%;max-height:90px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6625304284"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="theme-vdoing-content content__default"><h1 id="小程序websocket打印文字兼自动滚动-chatgpt"><a href="#小程序websocket打印文字兼自动滚动-chatgpt" class="header-anchor">#</a> 小程序WebSocket打印文字兼自动滚动（chatgpt）</h1> <ul><li>建立WebSocket连接</li> <li>使用队列存储</li> <li>通过队列<code>shift</code>方法来打印消息内容</li></ul> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>create-story__wrap<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>create-story__wrap--desc<span class="token punctuation">&quot;</span></span>
      <span class="token punctuation">&gt;</span></span>将根据故事参数和宝贝信息生成故事。如需修改，请前往“首页”的“故事参数设置”和“我的”中的“宝贝信息”进行设置。<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span>
    <span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>up-textarea</span>
      <span class="token attr-name">:customStyle</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{
        fontSize: '30rpx'
      }<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>storyTextare<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">maxlength</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>40<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>请输入你的故事描述<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">count</span>
    <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>up-textarea</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 生成故事按钮 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>submitBtn</span>
      <span class="token attr-name">:textValue</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>storyTextare<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">:content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">'</span>生成故事'<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">@handleSubmit</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sendMsg<span class="token punctuation">&quot;</span></span>
    <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 故事生成弹窗 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span>
    <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{ 'is-active': isShow }<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>popup-container<span class="token punctuation">&quot;</span></span>
  <span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span>
      <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>popup-bg<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>closePopup<span class="token punctuation">&quot;</span></span>
    <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>popup-content<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex-div-between<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>createStoryLoading<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>故事生成中...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">v-else</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>createStoryLoading<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>故事生成完成<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>close-button<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>up-icon</span>
            <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>close<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>24<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>closePopup<span class="token punctuation">&quot;</span></span>
          <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>up-icon</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 这里放置弹窗内容 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scroll-view</span>
        <span class="token attr-name">:scroll-top</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scrollTops<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">scroll-y</span>
        <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>popup-content__desc<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">@scroll</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleUserScroll<span class="token punctuation">&quot;</span></span>
      <span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span>
          <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>(item, index) in messageList<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>index<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>popup-content__message<span class="token punctuation">&quot;</span></span>
        <span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span>
            <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>popup-content__message-text<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">user-select</span>
            <span class="token punctuation">&gt;</span></span>{{ item.displayedText }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span>
          <span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scroll-view</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span>
        <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>!createStoryLoading<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>popup-content__btn<span class="token punctuation">&quot;</span></span>
      <span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span>
          <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>popup-content__btn--repeat<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sendMsg<span class="token punctuation">&quot;</span></span>
          <span class="token punctuation">&gt;</span></span>再次生成<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span>
        <span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span>
          <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>popup-content__btn--send<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>onSend<span class="token punctuation">&quot;</span></span>
          <span class="token punctuation">&gt;</span></span>推送至设备<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span>
        <span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 蓝牙提示弹窗 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>popBluetooth</span>
    <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>isShowPop<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">:popAuthTipType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>popAuthTipType<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">:isShow</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>isShowPop<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">@closePop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>closePop<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">@hanldeConnect</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>initConnectBluetooth<span class="token punctuation">&quot;</span></span>
  <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> onShow<span class="token punctuation">,</span> onUnload <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@dcloudio/uni-app'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref<span class="token punctuation">,</span> nextTick <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useBluetoothStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/stores/bluetoothStore.js'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useStoryStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/stores/storyStore.js'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useUserStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/stores/userStore.js'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> storeToRefs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'pinia'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> productDevicesObj <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/utils/config-data.js'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> iotDeviceActivateApi <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/api/xiaoice.js'</span>

<span class="token comment">// pinia获取故事实例</span>
<span class="token keyword">const</span> storyStore <span class="token operator">=</span> <span class="token function">useStoryStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> deviceSecret <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">storeToRefs</span><span class="token punctuation">(</span>storyStore<span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> setdeviceSecret <span class="token punctuation">}</span> <span class="token operator">=</span> storyStore
<span class="token comment">// pinia获取蓝牙实例</span>
<span class="token keyword">const</span> bluetoothStore <span class="token operator">=</span> <span class="token function">useBluetoothStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> isShowPop<span class="token punctuation">,</span> popAuthTipType<span class="token punctuation">,</span> wifi_state<span class="token punctuation">,</span> isConnectBle<span class="token punctuation">,</span> bindDeviceModel <span class="token punctuation">}</span> <span class="token operator">=</span>
  <span class="token function">storeToRefs</span><span class="token punctuation">(</span>bluetoothStore<span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span>
  setPopState<span class="token punctuation">,</span>
  setIsConnectBle<span class="token punctuation">,</span>
  connectBluetooth<span class="token punctuation">,</span>
  checkBluetooth<span class="token punctuation">,</span>
  notifyBLECharacteristicValueChange<span class="token punctuation">,</span>
  writeBLECharacteristicValue
<span class="token punctuation">}</span> <span class="token operator">=</span> bluetoothStore
<span class="token comment">// pinia获取宝宝信息</span>
<span class="token keyword">const</span> userStore <span class="token operator">=</span> <span class="token function">useUserStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> babayState <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">storeToRefs</span><span class="token punctuation">(</span>userStore<span class="token punctuation">)</span>

<span class="token comment">// 宝贝信息</span>
<span class="token keyword">const</span> babyInfoStr <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
<span class="token comment">// 用户的uuid</span>
<span class="token keyword">const</span> uuid <span class="token operator">=</span> uni<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span><span class="token string">'userInfo'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>uuid
<span class="token comment">// IOT设备的productId</span>
<span class="token keyword">const</span> productId <span class="token operator">=</span> productDevicesObj<span class="token punctuation">[</span>bindDeviceModel<span class="token punctuation">.</span>value<span class="token punctuation">]</span><span class="token punctuation">.</span>productId
<span class="token comment">// IOT设备的SN</span>
<span class="token keyword">const</span> deviceId <span class="token operator">=</span> uni<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span><span class="token string">'serialNo'</span><span class="token punctuation">)</span>
<span class="token comment">// 鉴权失败，重新获取密钥secret</span>
<span class="token keyword">let</span> secretFlag <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token comment">// 生成故事的描述</span>
<span class="token keyword">const</span> storyTextare <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">'喜羊羊故事'</span><span class="token punctuation">)</span>
<span class="token comment">// 生成故事的内容数组</span>
<span class="token keyword">const</span> messageList <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">// 生成故事的音频数组</span>
<span class="token keyword">const</span> messageAudioList <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">// 用于存储接收到的消息队列</span>
<span class="token keyword">const</span> messageQueue <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">// 用于标记当前是否正在打印消息</span>
<span class="token keyword">const</span> isTyping <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token comment">// 故事生产中的loading</span>
<span class="token keyword">const</span> createStoryLoading <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token comment">// 设置竖向滚动条位置</span>
<span class="token keyword">const</span> scrollTops <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token comment">// 用户是否滚动的标志</span>
<span class="token keyword">const</span> userScrolled <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>

<span class="token function">onShow</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 小程序与设备建立蓝牙连接</span>
  <span class="token function">initConnectBluetooth</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 初始化蓝牙与设备建立蓝牙连接</span>
<span class="token keyword">const</span> <span class="token function-variable function">initConnectBluetooth</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>productDevicesObj<span class="token punctuation">[</span>bindDeviceModel<span class="token punctuation">.</span>value<span class="token punctuation">]</span><span class="token operator">?.</span>isBluetoothControl<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">connectBluetooth</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'蓝牙connect'</span><span class="token punctuation">)</span>
      <span class="token comment">// IOT设备激活</span>
      <span class="token function">iotDeviceActivate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token comment">// 获取宝贝信息</span>
      <span class="token function">getBabyInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token comment">// 开始监听特征值uuid的变化</span>
      <span class="token function">listenCharacterUuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 设置加载动画状态</span>
<span class="token keyword">const</span> <span class="token function-variable function">setLoadingStatus</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">payload</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>payload<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    uni<span class="token punctuation">.</span><span class="token function">showLoading</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'推送中...'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">mask</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    uni<span class="token punctuation">.</span><span class="token function">hideLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 是否开启了蓝牙监听</span>
<span class="token keyword">let</span> isOpenNotify <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token comment">// 开启监听，监听蓝牙发送的内容</span>
<span class="token keyword">const</span> <span class="token function-variable function">listenCharacterUuid</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">packetValue<span class="token punctuation">,</span> packetType</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    isOpenNotify<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token comment">// 监听特征值的变化</span>
    <span class="token function">notifyBLECharacteristicValueChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">finally</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 接收蓝牙数据</span>
      <span class="token function">onBLECharacteristicValueChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'listenCharacterUuid error'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 接收蓝牙数据</span>
<span class="token keyword">const</span> <span class="token function-variable function">onBLECharacteristicValueChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  uni<span class="token punctuation">.</span><span class="token function">onBLECharacteristicValueChange</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'接收设备数据'</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span>
    <span class="token keyword">const</span> resHex <span class="token operator">=</span> <span class="token function">ab2hex</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'接收回来的值'</span><span class="token punctuation">,</span> resHex<span class="token punctuation">)</span>
    <span class="token comment">// 最后将16进制转换为ascii码，就能看到对应的结果</span>
    <span class="token keyword">const</span> packetType <span class="token operator">=</span> <span class="token function">fromCharCode</span><span class="token punctuation">(</span>resHex<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">fromCharCode</span><span class="token punctuation">(</span>resHex<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'接收到的包类型'</span><span class="token punctuation">,</span> packetType<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'接收到的设备的消息'</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span>

    <span class="token comment">// 更新设备配置</span>
    <span class="token function">unpdateDeviceConfig</span><span class="token punctuation">(</span>packetType<span class="token punctuation">,</span> result<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 更新设备控件状态</span>
<span class="token keyword">const</span> <span class="token function-variable function">unpdateDeviceConfig</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">packetType<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>packetType <span class="token operator">===</span> <span class="token number">22</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 数据校验成功0x01、播放中0x21</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">||</span> result <span class="token operator">===</span> <span class="token number">33</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 关闭loading状态</span>
      <span class="token function">closeLoadingStatus</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
      <span class="token comment">// 关闭弹窗并toast提示</span>
      isShow<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span>
      uni<span class="token punctuation">.</span><span class="token function">navigateBack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">delta</span><span class="token operator">:</span> <span class="token number">1</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token keyword">const</span> timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        uni<span class="token punctuation">.</span>$u<span class="token punctuation">.</span><span class="token function">toast</span><span class="token punctuation">(</span><span class="token string">'已推送至设备'</span><span class="token punctuation">)</span>
        <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">===</span> <span class="token number">2</span> <span class="token operator">||</span> result <span class="token operator">===</span> <span class="token number">37</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'数据校验失败'</span><span class="token punctuation">)</span>
      <span class="token comment">// 关闭loading状态</span>
      <span class="token function">closeLoadingStatus</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
      <span class="token comment">// 推送失败</span>
      uni<span class="token punctuation">.</span>$u<span class="token punctuation">.</span><span class="token function">toast</span><span class="token punctuation">(</span><span class="token string">'推送失败'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">===</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'数据校验中'</span><span class="token punctuation">)</span>
      <span class="token comment">// 开启loading状态</span>
      <span class="token function">setLoadingStatus</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 向蓝牙发送数据</span>
<span class="token keyword">const</span> <span class="token function-variable function">HeartSubmit</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">packetValue<span class="token punctuation">,</span> packetType</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 检查用户是否授权了蓝牙</span>
  <span class="token function">checkBluetooth</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 蓝牙已开启</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>available<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 如果未开启蓝牙监听功能，则开启</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isOpenNotify<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">listenCharacterUuid</span><span class="token punctuation">(</span>packetValue<span class="token punctuation">,</span> packetType<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 传递给蓝牙json格式的字符串</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'包的值：'</span><span class="token punctuation">,</span> packetValue<span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'包类型：'</span><span class="token punctuation">,</span> packetType<span class="token punctuation">)</span>

        <span class="token keyword">const</span> bufferData <span class="token operator">=</span> <span class="token function">textToBinaryAgreement</span><span class="token punctuation">(</span>packetValue<span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'bufferData'</span><span class="token punctuation">,</span> bufferData<span class="token punctuation">)</span>
        bufferData<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> packetItemData <span class="token operator">=</span> <span class="token function">assemblePacket</span><span class="token punctuation">(</span>
            packetType<span class="token punctuation">,</span>
            index<span class="token punctuation">,</span>
            bufferData<span class="token punctuation">.</span>length<span class="token punctuation">,</span>
            item
          <span class="token punctuation">)</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'分发的数据：'</span><span class="token punctuation">,</span> packetItemData<span class="token punctuation">)</span>

          <span class="token comment">// 向设备发送数据</span>
          <span class="token function">writeBLECharacteristicValue</span><span class="token punctuation">(</span>packetItemData<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
              <span class="token comment">// 发送数据成功</span>
              console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'发送数据成功'</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
              console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'HeartSubmit发送失败'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span>
              <span class="token comment">// 处理当前点击控件与设备蓝牙连接断开弹窗提示开启，并自动重连蓝牙</span>
              <span class="token function">checkDeviceBlueState</span><span class="token punctuation">(</span>packetValue<span class="token punctuation">,</span> packetType<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// 蓝牙未开启</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'蓝牙未开启'</span><span class="token punctuation">)</span>
        <span class="token function">setIsConnectBle</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
        <span class="token comment">// 用户未授权手机蓝牙权限</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isShowPop<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">setPopState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'获取蓝牙状态失败'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span>
      <span class="token comment">// 用户未授权小程序蓝牙权限</span>
      <span class="token function">setPopState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
      <span class="token function">setIsConnectBle</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 检查设备的蓝牙状态，若开启了蓝牙则直接执行控件指令，未开启则弹窗提示</span>
<span class="token keyword">const</span> <span class="token function-variable function">checkDeviceBlueState</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> controlType</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 连接蓝牙设备</span>
  <span class="token function">connectBluetooth</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'蓝牙connect'</span><span class="token punctuation">,</span> value<span class="token punctuation">,</span> controlType<span class="token punctuation">)</span>
      <span class="token comment">// 开始监听特征值uuid的变化</span>
      <span class="token function">listenCharacterUuid</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> controlType<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'checkDeviceBlueState error'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 关闭蓝牙提示弹出</span>
<span class="token keyword">const</span> <span class="token function-variable function">closePop</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">setPopState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token comment">// 进行初始化和连接蓝牙</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>isConnectBle<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 小程序与设备建立蓝牙连接</span>
    <span class="token function">initConnectBluetooth</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// IOT设备激活</span>
<span class="token keyword">const</span> <span class="token function-variable function">iotDeviceActivate</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">type</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 当前设备没有激活则激活</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>deviceSecret<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token punctuation">{</span>
      productId<span class="token punctuation">,</span>
      deviceId
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">iotDeviceActivateApi</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'res'</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>statusCode <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setdeviceSecret</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>secret<span class="token punctuation">)</span>

      <span class="token comment">// 鉴权失败，重连激活并生成故事</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">'sendMsg'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">initWebSocket</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 宝贝信息</span>
<span class="token keyword">const</span> <span class="token function-variable function">getBabyInfo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 使用 for...in 循环遍历对象的键和值</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> babayState<span class="token punctuation">.</span>value<span class="token punctuation">.</span>babyUserInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>babayState<span class="token punctuation">.</span>value<span class="token punctuation">.</span>babyUserInfo<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>babayState<span class="token punctuation">.</span>value<span class="token punctuation">.</span>babyUserInfo<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>babayState<span class="token punctuation">.</span>value<span class="token punctuation">.</span>babyUserInfo<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">===</span> <span class="token string">'name'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          babyInfoStr<span class="token punctuation">.</span>value <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">#宝贝昵称：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>babayState<span class="token punctuation">.</span>value<span class="token punctuation">.</span>babyUserInfo<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">===</span> <span class="token string">'sex'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          babyInfoStr<span class="token punctuation">.</span>value <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">#宝贝性别：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>babayState<span class="token punctuation">.</span>value<span class="token punctuation">.</span>babyUserInfo<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">===</span> <span class="token string">'birthday'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          babyInfoStr<span class="token punctuation">.</span>value <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">#出生年月：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>babayState<span class="token punctuation">.</span>value<span class="token punctuation">.</span>babyUserInfo<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">===</span> <span class="token string">'chineseAbillity'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          babyInfoStr<span class="token punctuation">.</span>value <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">#中文能力：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>babayState<span class="token punctuation">.</span>value<span class="token punctuation">.</span>babyUserInfo<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">===</span> <span class="token string">'themePreferences'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          babyInfoStr<span class="token punctuation">.</span>value <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">#主题偏好：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>babayState<span class="token punctuation">.</span>value<span class="token punctuation">.</span>babyUserInfo<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'宝贝信息：'</span><span class="token punctuation">,</span> babyInfoStr<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// WebSocket是否处于连接状态</span>
<span class="token keyword">let</span> socketOpen <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token comment">// WebSocket重连状态</span>
<span class="token keyword">let</span> lockReconnect <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token comment">// 初始化WebSocket</span>
<span class="token keyword">const</span> <span class="token function-variable function">initWebSocket</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">type</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">websocketConnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">websocketOnopen</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span>
  <span class="token function">websocketOnmessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">websocketOnclose</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">websocketOnerror</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 连接WebSocket</span>
<span class="token keyword">const</span> <span class="token function-variable function">websocketConnect</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VITE_XIAOICE_BASE_WS_URL</span><span class="token punctuation">)</span>
  uni<span class="token punctuation">.</span><span class="token function">connectSocket</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>
      <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VITE_XIAOICE_BASE_WS_URL</span>
    <span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/openapi/v1/iot-ws/characters/xiyangyang/sessions/story-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>uuid<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token comment">// WebSocket 服务器地址</span>
    <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'WebSocket连接成功'</span><span class="token punctuation">)</span>
      socketOpen <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      socketOpen <span class="token operator">=</span> <span class="token boolean">false</span>
      <span class="token function">reConnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 监听WebSocket连接打开事件</span>
<span class="token keyword">const</span> <span class="token function-variable function">websocketOnopen</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">type</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  uni<span class="token punctuation">.</span><span class="token function">onSocketOpen</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'WebSocket连接已打开'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">'sendMsg'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">sendMsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 向后端发送命令(发送数据,需要先uni.connectSocket,并在uni.onSocketOpen回调之后才能发送)</span>
<span class="token keyword">const</span> <span class="token function-variable function">sendMsg</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">type</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'连接状态'</span><span class="token punctuation">,</span> socketOpen<span class="token punctuation">)</span>
  <span class="token comment">// 如果WebSocket未连接或者无设备则直接不做任何处理</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>socketOpen<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">initWebSocket</span><span class="token punctuation">(</span><span class="token string">'sendMsg'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 打开生成故事弹窗并设置生成故事动画状态</span>
  isShow<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span>
  messageList<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  messageAudioList<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  createStoryLoading<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span>

  <span class="token comment">// 发送数据</span>
  <span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">context</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      productId<span class="token punctuation">,</span>
      deviceId<span class="token punctuation">,</span>
      <span class="token literal-property property">deviceSecret</span><span class="token operator">:</span> deviceSecret<span class="token punctuation">.</span>value
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">header</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'chat.text_in'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">requestId</span><span class="token operator">:</span> <span class="token string">'test123'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">ttsConfig</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">outputType</span><span class="token operator">:</span> <span class="token string">'OSS_LINK'</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">payload</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">text</span><span class="token operator">:</span> storyTextare<span class="token punctuation">.</span>value <span class="token operator">+</span> babyInfoStr<span class="token punctuation">.</span>value
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 处理发送数据</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'发送的数据：'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
  <span class="token comment">// 通过 WebSocket 连接发送数据</span>
  uni<span class="token punctuation">.</span><span class="token function">sendSocketMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    data<span class="token punctuation">,</span>
    <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'res'</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'sendSocketMessage'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 监听WebSocket接收消息事件</span>
<span class="token keyword">const</span> <span class="token function-variable function">websocketOnmessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  uni<span class="token punctuation">.</span><span class="token function">onSocketMessage</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> receiveMsg <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'收到消息：'</span><span class="token punctuation">,</span> receiveMsg<span class="token punctuation">)</span>
    <span class="token comment">// 鉴权失败，请核对context信息</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>receiveMsg<span class="token punctuation">.</span>payload<span class="token operator">?.</span>errno <span class="token operator">===</span> <span class="token string">'400403'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>secretFlag<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      secretFlag <span class="token operator">=</span> <span class="token boolean">true</span>
      isShow<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span>
      <span class="token function">setdeviceSecret</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
      <span class="token function">iotDeviceActivate</span><span class="token punctuation">(</span><span class="token string">'sendMsg'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 故事生成中，接收故事内容</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>receiveMsg<span class="token punctuation">.</span>payload<span class="token operator">?.</span>text<span class="token operator">?.</span>text<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> newMessage <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">fullText</span><span class="token operator">:</span> receiveMsg<span class="token punctuation">.</span>payload<span class="token punctuation">.</span>text<span class="token punctuation">.</span>text <span class="token operator">+</span> <span class="token string">'\n\n'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">displayedText</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
        <span class="token literal-property property">audioUrl</span><span class="token operator">:</span> receiveMsg<span class="token punctuation">.</span>payload<span class="token punctuation">.</span>audio<span class="token operator">?.</span>audioUrl <span class="token operator">||</span> <span class="token keyword">null</span>
      <span class="token punctuation">}</span>
      messageQueue<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>newMessage<span class="token punctuation">)</span>
      <span class="token function">processMessageQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 监听WebSocket关闭事件</span>
<span class="token keyword">const</span> <span class="token function-variable function">websocketOnclose</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  uni<span class="token punctuation">.</span><span class="token function">onSocketClose</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'连接已关闭：'</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span>
    socketOpen <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token operator">?.</span>code <span class="token operator">!==</span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'WebSocket 非正常断开重连...'</span><span class="token punctuation">)</span>
      <span class="token function">reConnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 监听WebSocket错误事件</span>
<span class="token keyword">const</span> <span class="token function-variable function">websocketOnerror</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  uni<span class="token punctuation">.</span><span class="token function">onSocketError</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'WebSocket出现错误：'</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span>
    socketOpen <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token operator">?.</span>code <span class="token operator">!==</span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'WebSocket 非正常断开重连...'</span><span class="token punctuation">)</span>
      <span class="token function">reConnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 尝试重连WebSocket</span>
<span class="token keyword">const</span> <span class="token function-variable function">reConnect</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>lockReconnect<span class="token punctuation">)</span> <span class="token keyword">return</span>
  lockReconnect <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token comment">// 没连接上会一直重连，设置延迟避免请求过多</span>
  <span class="token keyword">const</span> websocketTimer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'尝试重连...'</span><span class="token punctuation">)</span>
    <span class="token comment">// WebSocket断开时需要重新连接</span>
    <span class="token function">initWebSocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    lockReconnect <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token function">clearTimeout</span><span class="token punctuation">(</span>websocketTimer<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 关闭WebSocket连接</span>
<span class="token keyword">const</span> <span class="token function-variable function">closeWebSocket</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  uni<span class="token punctuation">.</span><span class="token function">closeSocket</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
    <span class="token literal-property property">reason</span><span class="token operator">:</span> <span class="token string">'close reason from client'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'uni.closeSocket success'</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'uni.closeSocket fail'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">complete</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'uni.closeSocket complete'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 处理内容打印样式</span>
<span class="token keyword">const</span> <span class="token function-variable function">startTypingEffect</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">message<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  message<span class="token punctuation">.</span>displayedText <span class="token operator">=</span> <span class="token string">''</span>
  <span class="token keyword">let</span> charIndex <span class="token operator">=</span> <span class="token number">0</span>

  <span class="token keyword">const</span> intervalId <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>charIndex <span class="token operator">&lt;</span> message<span class="token punctuation">.</span>fullText<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      message<span class="token punctuation">.</span>displayedText <span class="token operator">+=</span> message<span class="token punctuation">.</span>fullText<span class="token punctuation">[</span>charIndex<span class="token punctuation">]</span>
      charIndex<span class="token operator">++</span>
      <span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>userScrolled<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">scrollToBottom</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">clearInterval</span><span class="token punctuation">(</span>intervalId<span class="token punctuation">)</span>
      <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token comment">// 调整打字速度</span>
<span class="token punctuation">}</span>

<span class="token comment">// 队列循环打印队列中的消息</span>
<span class="token keyword">const</span> <span class="token function-variable function">processMessageQueue</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 故事生成完成</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>messageQueue<span class="token punctuation">.</span>value<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    createStoryLoading<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'音频列表：'</span><span class="token punctuation">,</span> messageAudioList<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>messageQueue<span class="token punctuation">.</span>value<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>isTyping<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    isTyping<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token keyword">const</span> newMessage <span class="token operator">=</span> messageQueue<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    messageList<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>newMessage<span class="token punctuation">)</span>

    <span class="token comment">// 如果有 audioUrl，添加到 messageAudioList 数组中</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>newMessage<span class="token punctuation">.</span>audioUrl<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      messageAudioList<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>newMessage<span class="token punctuation">.</span>audioUrl<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token function">startTypingEffect</span><span class="token punctuation">(</span>newMessage<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      isTyping<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span>
      <span class="token function">processMessageQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 监听用户滚动事件</span>
<span class="token keyword">const</span> <span class="token function-variable function">handleUserScroll</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 如果不是打印自动触发的滚动，则认为是用户滚动</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Number<span class="token punctuation">.</span><span class="token function">isInteger</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>scrollTop<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    userScrolled<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 打印自动滚动功能</span>
<span class="token keyword">const</span> <span class="token function-variable function">scrollToBottom</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> query <span class="token operator">=</span> uni<span class="token punctuation">.</span><span class="token function">createSelectorQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'.popup-content__desc'</span><span class="token punctuation">)</span>
    query
      <span class="token punctuation">.</span><span class="token function">boundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">rect</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>rect<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// 无滚动条方式自动滚动方式</span>
          <span class="token comment">// uni.pageScrollTo({</span>
          <span class="token comment">//   scrollTop: rect.bottom,</span>
          <span class="token comment">//   duration: 300</span>
          <span class="token comment">// })</span>
          <span class="token comment">// 有滚动条自动滚动方式</span>
          scrollTops<span class="token punctuation">.</span>value <span class="token operator">+=</span> rect<span class="token punctuation">.</span>bottom
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 弹窗显隐状态</span>
<span class="token keyword">const</span> isShow <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token comment">// 关闭生成故事弹窗</span>
<span class="token keyword">const</span> <span class="token function-variable function">closePopup</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  isShow<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span>
  messageList<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  messageAudioList<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  createStoryLoading<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>

<span class="token comment">// 推送至设备</span>
<span class="token keyword">const</span> <span class="token function-variable function">onSend</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 向设备发送数据</span>
  <span class="token function">HeartSubmit</span><span class="token punctuation">(</span>
    <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>messageAudioList<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">,</span>
    blePacketTypeObj<span class="token punctuation">[</span><span class="token string">'play_url'</span><span class="token punctuation">]</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">onUnload</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'返回上一页'</span><span class="token punctuation">)</span>
  <span class="token comment">// 生成故事完成后关闭WebSocket连接</span>
  <span class="token function">closeWebSocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scss<span class="token punctuation">&quot;</span></span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">:deep(.u-button)</span> <span class="token punctuation">{</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 80rpx <span class="token important">!important</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">:deep(.u-textarea__field)</span> <span class="token punctuation">{</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 30rpx <span class="token important">!important</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.create-story__wrap</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 220rpx<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 0 40rpx<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #000000<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 30rpx<span class="token punctuation">;</span>

  <span class="token selector">&amp;--desc</span> <span class="token punctuation">{</span>
    <span class="token property">margin-top</span><span class="token punctuation">:</span> 30rpx<span class="token punctuation">;</span>
    <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 60rpx<span class="token punctuation">;</span>
    <span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--text-color<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> 26rpx<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token selector">.theme-performance-box</span> <span class="token punctuation">{</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.temme-performance-box--tag</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-wrap</span><span class="token punctuation">:</span> wrap<span class="token punctuation">;</span>
  <span class="token property">padding-left</span><span class="token punctuation">:</span> 20rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.common-text__style</span> <span class="token punctuation">{</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 30rpx<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--text-color<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.tag-item__theme</span> <span class="token punctuation">{</span>
  <span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 26%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 60rpx<span class="token punctuation">;</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--common-color<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span> 2rpx solid <span class="token function">var</span><span class="token punctuation">(</span>--common-color<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--text-color<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 8rpx<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 30rpx<span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> 15rpx 20rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.active-tag</span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--XYY--light--theme-color<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--XYY--theme-color<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span> 2rpx solid <span class="token function">var</span><span class="token punctuation">(</span>--XYY--theme-color<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.popup-container</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>
  <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">right</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">z-index</span><span class="token punctuation">:</span> 19999<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> flex-end<span class="token punctuation">;</span>
  <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">transition</span><span class="token punctuation">:</span> opacity 0.2s ease-in-out<span class="token punctuation">;</span>
  <span class="token property">opacity</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">pointer-events</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.popup-container.is-active</span> <span class="token punctuation">{</span>
  <span class="token property">opacity</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
  <span class="token property">pointer-events</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.popup-bg</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>
  <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">right</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0.5<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">z-index</span><span class="token punctuation">:</span> 19999<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.popup-content</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
  <span class="token property">z-index</span><span class="token punctuation">:</span> 20000<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>
  <span class="token property">border-top-left-radius</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
  <span class="token property">border-top-right-radius</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
  <span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translateY</span><span class="token punctuation">(</span>100%<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">transition</span><span class="token punctuation">:</span> transform 0.3s ease-in-out<span class="token punctuation">;</span>

  <span class="token selector">&amp;__desc</span> <span class="token punctuation">{</span>
    <span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span>
    <span class="token property">margin</span><span class="token punctuation">:</span> 40rpx 0<span class="token punctuation">;</span>
    <span class="token property">padding</span><span class="token punctuation">:</span> 0 20rpx<span class="token punctuation">;</span>
    <span class="token property">border-radius</span><span class="token punctuation">:</span> 16rpx<span class="token punctuation">;</span>
    <span class="token property">color</span><span class="token punctuation">:</span> #1d2129<span class="token punctuation">;</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> 28rpx<span class="token punctuation">;</span>
    <span class="token property">max-height</span><span class="token punctuation">:</span> 600rpx<span class="token punctuation">;</span>
    <span class="token property">overflow-y</span><span class="token punctuation">:</span> scroll<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token selector">&amp;__message-text</span> <span class="token punctuation">{</span>
    <span class="token property">white-space</span><span class="token punctuation">:</span> pre-wrap<span class="token punctuation">;</span>
    <span class="token property">word-wrap</span><span class="token punctuation">:</span> break-word<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token selector">&amp;__btn</span> <span class="token punctuation">{</span>
    <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
    <span class="token property">justify-content</span><span class="token punctuation">:</span> space-around<span class="token punctuation">;</span>
    <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 20rpx<span class="token punctuation">;</span>

    <span class="token selector">&amp;--repeat</span> <span class="token punctuation">{</span>
      <span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span>
      <span class="token property">padding</span><span class="token punctuation">:</span> 15rpx 30rpx<span class="token punctuation">;</span>
      <span class="token property">border</span><span class="token punctuation">:</span> 2rpx solid <span class="token function">var</span><span class="token punctuation">(</span>--XYY--theme-color<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--XYY--theme-color<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token property">font-size</span><span class="token punctuation">:</span> 28rpx<span class="token punctuation">;</span>
      <span class="token property">border-radius</span><span class="token punctuation">:</span> 8rpx<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token selector">&amp;--send</span> <span class="token punctuation">{</span>
      <span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span>
      <span class="token property">padding</span><span class="token punctuation">:</span> 15rpx 30rpx<span class="token punctuation">;</span>
      <span class="token property">background</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--XYY--theme-color<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token property">color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
      <span class="token property">font-size</span><span class="token punctuation">:</span> 28rpx<span class="token punctuation">;</span>
      <span class="token property">border-radius</span><span class="token punctuation">:</span> 8rpx<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token selector">.popup-container.is-active .popup-content</span> <span class="token punctuation">{</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translateY</span><span class="token punctuation">(</span>0<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.close-button</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">justify-content</span><span class="token punctuation">:</span> flex-end<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 16px<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #333<span class="token punctuation">;</span>
  <span class="token property">cursor</span><span class="token punctuation">:</span> pointer<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.flex-div-between</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">justify-content</span><span class="token punctuation">:</span> space-between<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 30rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br><span class="line-number">304</span><br><span class="line-number">305</span><br><span class="line-number">306</span><br><span class="line-number">307</span><br><span class="line-number">308</span><br><span class="line-number">309</span><br><span class="line-number">310</span><br><span class="line-number">311</span><br><span class="line-number">312</span><br><span class="line-number">313</span><br><span class="line-number">314</span><br><span class="line-number">315</span><br><span class="line-number">316</span><br><span class="line-number">317</span><br><span class="line-number">318</span><br><span class="line-number">319</span><br><span class="line-number">320</span><br><span class="line-number">321</span><br><span class="line-number">322</span><br><span class="line-number">323</span><br><span class="line-number">324</span><br><span class="line-number">325</span><br><span class="line-number">326</span><br><span class="line-number">327</span><br><span class="line-number">328</span><br><span class="line-number">329</span><br><span class="line-number">330</span><br><span class="line-number">331</span><br><span class="line-number">332</span><br><span class="line-number">333</span><br><span class="line-number">334</span><br><span class="line-number">335</span><br><span class="line-number">336</span><br><span class="line-number">337</span><br><span class="line-number">338</span><br><span class="line-number">339</span><br><span class="line-number">340</span><br><span class="line-number">341</span><br><span class="line-number">342</span><br><span class="line-number">343</span><br><span class="line-number">344</span><br><span class="line-number">345</span><br><span class="line-number">346</span><br><span class="line-number">347</span><br><span class="line-number">348</span><br><span class="line-number">349</span><br><span class="line-number">350</span><br><span class="line-number">351</span><br><span class="line-number">352</span><br><span class="line-number">353</span><br><span class="line-number">354</span><br><span class="line-number">355</span><br><span class="line-number">356</span><br><span class="line-number">357</span><br><span class="line-number">358</span><br><span class="line-number">359</span><br><span class="line-number">360</span><br><span class="line-number">361</span><br><span class="line-number">362</span><br><span class="line-number">363</span><br><span class="line-number">364</span><br><span class="line-number">365</span><br><span class="line-number">366</span><br><span class="line-number">367</span><br><span class="line-number">368</span><br><span class="line-number">369</span><br><span class="line-number">370</span><br><span class="line-number">371</span><br><span class="line-number">372</span><br><span class="line-number">373</span><br><span class="line-number">374</span><br><span class="line-number">375</span><br><span class="line-number">376</span><br><span class="line-number">377</span><br><span class="line-number">378</span><br><span class="line-number">379</span><br><span class="line-number">380</span><br><span class="line-number">381</span><br><span class="line-number">382</span><br><span class="line-number">383</span><br><span class="line-number">384</span><br><span class="line-number">385</span><br><span class="line-number">386</span><br><span class="line-number">387</span><br><span class="line-number">388</span><br><span class="line-number">389</span><br><span class="line-number">390</span><br><span class="line-number">391</span><br><span class="line-number">392</span><br><span class="line-number">393</span><br><span class="line-number">394</span><br><span class="line-number">395</span><br><span class="line-number">396</span><br><span class="line-number">397</span><br><span class="line-number">398</span><br><span class="line-number">399</span><br><span class="line-number">400</span><br><span class="line-number">401</span><br><span class="line-number">402</span><br><span class="line-number">403</span><br><span class="line-number">404</span><br><span class="line-number">405</span><br><span class="line-number">406</span><br><span class="line-number">407</span><br><span class="line-number">408</span><br><span class="line-number">409</span><br><span class="line-number">410</span><br><span class="line-number">411</span><br><span class="line-number">412</span><br><span class="line-number">413</span><br><span class="line-number">414</span><br><span class="line-number">415</span><br><span class="line-number">416</span><br><span class="line-number">417</span><br><span class="line-number">418</span><br><span class="line-number">419</span><br><span class="line-number">420</span><br><span class="line-number">421</span><br><span class="line-number">422</span><br><span class="line-number">423</span><br><span class="line-number">424</span><br><span class="line-number">425</span><br><span class="line-number">426</span><br><span class="line-number">427</span><br><span class="line-number">428</span><br><span class="line-number">429</span><br><span class="line-number">430</span><br><span class="line-number">431</span><br><span class="line-number">432</span><br><span class="line-number">433</span><br><span class="line-number">434</span><br><span class="line-number">435</span><br><span class="line-number">436</span><br><span class="line-number">437</span><br><span class="line-number">438</span><br><span class="line-number">439</span><br><span class="line-number">440</span><br><span class="line-number">441</span><br><span class="line-number">442</span><br><span class="line-number">443</span><br><span class="line-number">444</span><br><span class="line-number">445</span><br><span class="line-number">446</span><br><span class="line-number">447</span><br><span class="line-number">448</span><br><span class="line-number">449</span><br><span class="line-number">450</span><br><span class="line-number">451</span><br><span class="line-number">452</span><br><span class="line-number">453</span><br><span class="line-number">454</span><br><span class="line-number">455</span><br><span class="line-number">456</span><br><span class="line-number">457</span><br><span class="line-number">458</span><br><span class="line-number">459</span><br><span class="line-number">460</span><br><span class="line-number">461</span><br><span class="line-number">462</span><br><span class="line-number">463</span><br><span class="line-number">464</span><br><span class="line-number">465</span><br><span class="line-number">466</span><br><span class="line-number">467</span><br><span class="line-number">468</span><br><span class="line-number">469</span><br><span class="line-number">470</span><br><span class="line-number">471</span><br><span class="line-number">472</span><br><span class="line-number">473</span><br><span class="line-number">474</span><br><span class="line-number">475</span><br><span class="line-number">476</span><br><span class="line-number">477</span><br><span class="line-number">478</span><br><span class="line-number">479</span><br><span class="line-number">480</span><br><span class="line-number">481</span><br><span class="line-number">482</span><br><span class="line-number">483</span><br><span class="line-number">484</span><br><span class="line-number">485</span><br><span class="line-number">486</span><br><span class="line-number">487</span><br><span class="line-number">488</span><br><span class="line-number">489</span><br><span class="line-number">490</span><br><span class="line-number">491</span><br><span class="line-number">492</span><br><span class="line-number">493</span><br><span class="line-number">494</span><br><span class="line-number">495</span><br><span class="line-number">496</span><br><span class="line-number">497</span><br><span class="line-number">498</span><br><span class="line-number">499</span><br><span class="line-number">500</span><br><span class="line-number">501</span><br><span class="line-number">502</span><br><span class="line-number">503</span><br><span class="line-number">504</span><br><span class="line-number">505</span><br><span class="line-number">506</span><br><span class="line-number">507</span><br><span class="line-number">508</span><br><span class="line-number">509</span><br><span class="line-number">510</span><br><span class="line-number">511</span><br><span class="line-number">512</span><br><span class="line-number">513</span><br><span class="line-number">514</span><br><span class="line-number">515</span><br><span class="line-number">516</span><br><span class="line-number">517</span><br><span class="line-number">518</span><br><span class="line-number">519</span><br><span class="line-number">520</span><br><span class="line-number">521</span><br><span class="line-number">522</span><br><span class="line-number">523</span><br><span class="line-number">524</span><br><span class="line-number">525</span><br><span class="line-number">526</span><br><span class="line-number">527</span><br><span class="line-number">528</span><br><span class="line-number">529</span><br><span class="line-number">530</span><br><span class="line-number">531</span><br><span class="line-number">532</span><br><span class="line-number">533</span><br><span class="line-number">534</span><br><span class="line-number">535</span><br><span class="line-number">536</span><br><span class="line-number">537</span><br><span class="line-number">538</span><br><span class="line-number">539</span><br><span class="line-number">540</span><br><span class="line-number">541</span><br><span class="line-number">542</span><br><span class="line-number">543</span><br><span class="line-number">544</span><br><span class="line-number">545</span><br><span class="line-number">546</span><br><span class="line-number">547</span><br><span class="line-number">548</span><br><span class="line-number">549</span><br><span class="line-number">550</span><br><span class="line-number">551</span><br><span class="line-number">552</span><br><span class="line-number">553</span><br><span class="line-number">554</span><br><span class="line-number">555</span><br><span class="line-number">556</span><br><span class="line-number">557</span><br><span class="line-number">558</span><br><span class="line-number">559</span><br><span class="line-number">560</span><br><span class="line-number">561</span><br><span class="line-number">562</span><br><span class="line-number">563</span><br><span class="line-number">564</span><br><span class="line-number">565</span><br><span class="line-number">566</span><br><span class="line-number">567</span><br><span class="line-number">568</span><br><span class="line-number">569</span><br><span class="line-number">570</span><br><span class="line-number">571</span><br><span class="line-number">572</span><br><span class="line-number">573</span><br><span class="line-number">574</span><br><span class="line-number">575</span><br><span class="line-number">576</span><br><span class="line-number">577</span><br><span class="line-number">578</span><br><span class="line-number">579</span><br><span class="line-number">580</span><br><span class="line-number">581</span><br><span class="line-number">582</span><br><span class="line-number">583</span><br><span class="line-number">584</span><br><span class="line-number">585</span><br><span class="line-number">586</span><br><span class="line-number">587</span><br><span class="line-number">588</span><br><span class="line-number">589</span><br><span class="line-number">590</span><br><span class="line-number">591</span><br><span class="line-number">592</span><br><span class="line-number">593</span><br><span class="line-number">594</span><br><span class="line-number">595</span><br><span class="line-number">596</span><br><span class="line-number">597</span><br><span class="line-number">598</span><br><span class="line-number">599</span><br><span class="line-number">600</span><br><span class="line-number">601</span><br><span class="line-number">602</span><br><span class="line-number">603</span><br><span class="line-number">604</span><br><span class="line-number">605</span><br><span class="line-number">606</span><br><span class="line-number">607</span><br><span class="line-number">608</span><br><span class="line-number">609</span><br><span class="line-number">610</span><br><span class="line-number">611</span><br><span class="line-number">612</span><br><span class="line-number">613</span><br><span class="line-number">614</span><br><span class="line-number">615</span><br><span class="line-number">616</span><br><span class="line-number">617</span><br><span class="line-number">618</span><br><span class="line-number">619</span><br><span class="line-number">620</span><br><span class="line-number">621</span><br><span class="line-number">622</span><br><span class="line-number">623</span><br><span class="line-number">624</span><br><span class="line-number">625</span><br><span class="line-number">626</span><br><span class="line-number">627</span><br><span class="line-number">628</span><br><span class="line-number">629</span><br><span class="line-number">630</span><br><span class="line-number">631</span><br><span class="line-number">632</span><br><span class="line-number">633</span><br><span class="line-number">634</span><br><span class="line-number">635</span><br><span class="line-number">636</span><br><span class="line-number">637</span><br><span class="line-number">638</span><br><span class="line-number">639</span><br><span class="line-number">640</span><br><span class="line-number">641</span><br><span class="line-number">642</span><br><span class="line-number">643</span><br><span class="line-number">644</span><br><span class="line-number">645</span><br><span class="line-number">646</span><br><span class="line-number">647</span><br><span class="line-number">648</span><br><span class="line-number">649</span><br><span class="line-number">650</span><br><span class="line-number">651</span><br><span class="line-number">652</span><br><span class="line-number">653</span><br><span class="line-number">654</span><br><span class="line-number">655</span><br><span class="line-number">656</span><br><span class="line-number">657</span><br><span class="line-number">658</span><br><span class="line-number">659</span><br><span class="line-number">660</span><br><span class="line-number">661</span><br><span class="line-number">662</span><br><span class="line-number">663</span><br><span class="line-number">664</span><br><span class="line-number">665</span><br><span class="line-number">666</span><br><span class="line-number">667</span><br><span class="line-number">668</span><br><span class="line-number">669</span><br><span class="line-number">670</span><br><span class="line-number">671</span><br><span class="line-number">672</span><br><span class="line-number">673</span><br><span class="line-number">674</span><br><span class="line-number">675</span><br><span class="line-number">676</span><br><span class="line-number">677</span><br><span class="line-number">678</span><br><span class="line-number">679</span><br><span class="line-number">680</span><br><span class="line-number">681</span><br><span class="line-number">682</span><br><span class="line-number">683</span><br><span class="line-number">684</span><br><span class="line-number">685</span><br><span class="line-number">686</span><br><span class="line-number">687</span><br><span class="line-number">688</span><br><span class="line-number">689</span><br><span class="line-number">690</span><br><span class="line-number">691</span><br><span class="line-number">692</span><br><span class="line-number">693</span><br><span class="line-number">694</span><br><span class="line-number">695</span><br><span class="line-number">696</span><br><span class="line-number">697</span><br><span class="line-number">698</span><br><span class="line-number">699</span><br><span class="line-number">700</span><br><span class="line-number">701</span><br><span class="line-number">702</span><br><span class="line-number">703</span><br><span class="line-number">704</span><br><span class="line-number">705</span><br><span class="line-number">706</span><br><span class="line-number">707</span><br><span class="line-number">708</span><br><span class="line-number">709</span><br><span class="line-number">710</span><br><span class="line-number">711</span><br><span class="line-number">712</span><br><span class="line-number">713</span><br><span class="line-number">714</span><br><span class="line-number">715</span><br><span class="line-number">716</span><br><span class="line-number">717</span><br><span class="line-number">718</span><br><span class="line-number">719</span><br><span class="line-number">720</span><br><span class="line-number">721</span><br><span class="line-number">722</span><br><span class="line-number">723</span><br><span class="line-number">724</span><br><span class="line-number">725</span><br><span class="line-number">726</span><br><span class="line-number">727</span><br><span class="line-number">728</span><br><span class="line-number">729</span><br><span class="line-number">730</span><br><span class="line-number">731</span><br><span class="line-number">732</span><br><span class="line-number">733</span><br><span class="line-number">734</span><br><span class="line-number">735</span><br><span class="line-number">736</span><br><span class="line-number">737</span><br><span class="line-number">738</span><br><span class="line-number">739</span><br><span class="line-number">740</span><br><span class="line-number">741</span><br><span class="line-number">742</span><br><span class="line-number">743</span><br><span class="line-number">744</span><br><span class="line-number">745</span><br><span class="line-number">746</span><br><span class="line-number">747</span><br><span class="line-number">748</span><br><span class="line-number">749</span><br><span class="line-number">750</span><br><span class="line-number">751</span><br><span class="line-number">752</span><br><span class="line-number">753</span><br><span class="line-number">754</span><br><span class="line-number">755</span><br><span class="line-number">756</span><br><span class="line-number">757</span><br><span class="line-number">758</span><br><span class="line-number">759</span><br><span class="line-number">760</span><br><span class="line-number">761</span><br><span class="line-number">762</span><br><span class="line-number">763</span><br><span class="line-number">764</span><br><span class="line-number">765</span><br><span class="line-number">766</span><br><span class="line-number">767</span><br><span class="line-number">768</span><br><span class="line-number">769</span><br><span class="line-number">770</span><br><span class="line-number">771</span><br><span class="line-number">772</span><br><span class="line-number">773</span><br><span class="line-number">774</span><br><span class="line-number">775</span><br><span class="line-number">776</span><br><span class="line-number">777</span><br><span class="line-number">778</span><br><span class="line-number">779</span><br><span class="line-number">780</span><br><span class="line-number">781</span><br><span class="line-number">782</span><br><span class="line-number">783</span><br><span class="line-number">784</span><br><span class="line-number">785</span><br><span class="line-number">786</span><br><span class="line-number">787</span><br><span class="line-number">788</span><br><span class="line-number">789</span><br><span class="line-number">790</span><br><span class="line-number">791</span><br><span class="line-number">792</span><br><span class="line-number">793</span><br><span class="line-number">794</span><br><span class="line-number">795</span><br><span class="line-number">796</span><br><span class="line-number">797</span><br><span class="line-number">798</span><br><span class="line-number">799</span><br><span class="line-number">800</span><br><span class="line-number">801</span><br><span class="line-number">802</span><br><span class="line-number">803</span><br><span class="line-number">804</span><br><span class="line-number">805</span><br><span class="line-number">806</span><br><span class="line-number">807</span><br><span class="line-number">808</span><br></div></div></div></div> <div class="page-slot page-slot-bottom"><!-- 横向自适应 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6620245489"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/Aiden124578/my_blog/edit/master/docs/03.技术/25.小程序chatgpt/05.小程序WebSocket打印文字兼自动滚动（chatgpt）.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2024/08/05, 18:11:13</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/my_blog/pages/f4c038/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">Vue3实战难点</div></a> <a href="/my_blog/pages/785e56/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">小程序WIFI配网</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/my_blog/pages/f4c038/" class="prev">Vue3实战难点</a></span> <span class="next"><a href="/my_blog/pages/785e56/">小程序WIFI配网</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/my_blog/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/my_blog/pages/d9915d/"><div>
            大文件分片上传
            <!----></div></a> <span class="date">08-05</span></dt></dl><dl><dd>02</dd> <dt><a href="/my_blog/pages/8deb1d/"><div>
            Vue3实现OSS存储
            <!----></div></a> <span class="date">08-05</span></dt></dl><dl><dd>03</dd> <dt><a href="/my_blog/pages/66e106/"><div>
            H5 TTS
            <!----></div></a> <span class="date">08-05</span></dt></dl> <dl><dd></dd> <dt><a href="/my_blog/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:1047929038@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/Aiden124578" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2025
    <span>Aiden Wu | <a href="https://github.com/Aiden124578/my_blog/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <div class="custom-html-window custom-html-window-rb" style="display:;"><div class="custom-wrapper"><span class="close-but">×</span> <div><!-- 固定160*160px -->
      <ins class="adsbygoogle"
          style="display:inline-block;max-width:160px;max-height:160px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="8377369658"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
      </div></div></div></div><div class="global-ui"><div></div></div></div>
    <script src="/my_blog/assets/js/app.2b316682.js" defer></script><script src="/my_blog/assets/js/2.f62b317f.js" defer></script><script src="/my_blog/assets/js/90.12f92057.js" defer></script>
  </body>
</html>
